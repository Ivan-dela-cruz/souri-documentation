(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["RenuxContainerCommon"],{"4O/9":function(e,t,n){var r=n("Sxd8"),s="Expected a function";e.exports=function(e,t){var n;if("function"!=typeof t)throw new TypeError(s);return e=r(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}},"573u":function(e,t,n){n.d(t,"a",(function(){return s}));const r=!("undefined"==typeof window||!window.performance||!window.performance.now);function s(e,t,n){this.category=e,this.variable=t,this.label=n,this.startTime,this.elapsedTime}function a(){return r?window.performance.now():Date.now()}function i(){this.timers={}}s.prototype.start=function(){return this.startTime=a(),this},s.prototype.end=function(){return this.elapsedTime=Math.round(a()-this.startTime),this.startTime=r?Math.round(this.startTime):null,this},s.prototype.getCompletedTime=function(){return this.elapsedTime},s.prototype.send=function(){if(this.elapsedTime>0&&this.elapsedTime<6e5){const{category:e,variable:t,label:r,elapsedTime:s}=this;(()=>Promise.resolve().then(n.bind(null,"rh3l")))().then(({default:n})=>{n.logToServer(n.SERVER_LOG_TYPE.INTERACTION_TIMING,n.HTTP_METHOD.POST,{category:e,variable:t,label:r,time:s})})}return this},i.prototype.start=function(e,t,n,...r){const a=Array.prototype.slice.call([e,t,n,...r],0,2).join(":"),i=new s(e,t,n).start();this.timers[a]=i},i.prototype.end=function(e,t,n){const r=e+":"+t,s=this.timers[r];return s&&(s.end(),n&&s.send(),delete this.timers[r]),s};new i},CzMn:function(e,t,n){n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n("QLqj");function s(e){const t={};return e.forEach(e=>{const n=r.b.localStorage.getItem(e);n&&("signupInterestsPickerStartTime"===e?t.signupInterestsPickerTimeSpent=Date.now()-n:t[e]=n)}),JSON.stringify(t)}function a(){return s(["signupInterestsPickerScrollDown","signupInterestsPickerStartTime"])}function i(){return s(["signupTriedSkipInputName","signupTriedSkipGender","unauthTopicsFollowed"])}},HZII:function(e,t,n){var r=n("4O/9");e.exports=function(e){return r(2,e)}},ItC7:function(e,t,n){n.r(t),n.d(t,"isRenuxBestPinsFallBack",(function(){return w})),n.d(t,"RenuxContainer",(function(){return x}));var r=n("q1tI"),s=n.n(r),a=n("/MKj"),i=n("QbJe"),o=n("NdXn"),l=n("MKmU"),c=n("joD6"),d=n("ANjH"),u=n("gC5q"),p=n("Wer7"),h=n("0/lc"),m=n("U4JR"),g=n("zXAL"),f=n("5239");function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const w=e=>e&&e.display_data&&e.display_data.refresh_homefeed_background;class x extends r.Component{constructor(...e){super(...e),b(this,"inRenuxExperience",()=>{const{experience:e}=this.props;return e&&500278===e.experience_id}),b(this,"handleDismiss",()=>{const{dismissCallback:e,experience:t,experienceClient:n,fetchUserHomefeedResource:r,viewer:s}=this.props;Object(m.a)(101,{component:17,element:1150,view:213}),this.inRenuxExperience()&&n.dismissExperience(11,500278),w(t)&&r(s),e&&e()}),b(this,"handleComplete",()=>{const{completeCallback:e,completeRenuxAction:t,experienceClient:n,fetchUserHomefeedResource:r,setRenuxUserState:s,viewer:a}=this.props;Object(m.a)(101,{component:17,element:96,view:213}),this.inRenuxExperience()&&n.completeExperience(11,500278),s(parseInt((new Date).getTime()/1e3,10)),t(),r(a),e&&e()})}componentDidMount(){const{experienceClient:e}=this.props;this.inRenuxExperience()&&e.viewExperience(11,500278)}render(){const{experience:e,isSimpleRenux:t}=this.props;if(t||this.inRenuxExperience()){const n=e&&e.display_data||{},r=t?f.y:n;return s.a.createElement(i.a,Object.assign({},Object(u.a)(o.a,!0)(r),{handleComplete:this.handleComplete,handleDismiss:this.handleDismiss},this.props))}return null}}t.default=Object(d.compose)(Object(a.connect)(null,e=>({completeRenuxAction:()=>e({type:"COMPLETE_RENUX"}),fetchUserHomefeedResource:t=>e(Object(p.a)("UserHomefeedResource",Object(l.a)({inNux:!0,staticFeed:!1,viewerIsPartner:t.isPartner}))),setRenuxUserState:t=>e(Object(h.a)(f.v,t))})),g.a,c.a)(x)},L2Gz:function(e,t,n){n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return d}));var r=n("QLqj");function s(e,t){return e.some(e=>e.id===t.id)}function a(e){const t=[];if(e){const n=72e5,r=Date.now()-n;for(const s of e)s.ts>=r&&("string"==typeof s.image_signature&&t.push(s.image_signature),"string"==typeof s.first_pin_image_signature&&t.push(s.first_pin_image_signature))}return t}function i(){return{plpImages:a(r.b.localStorage.getItem("visitedPinLandingPagesBeforeLogin")||[]),blpImages:a(r.b.localStorage.getItem("visitedBoardLandingPagesBeforeLogin")||[])}}function o(e){return e.url.split("/").pop().replace(/(--.*|\.jpg)$/g,"")}function l(e){const t=e.log_data;return t&&JSON.parse(t).source||""}const c=5e-4;function d(e,t=c){const n=e=>{const t=e.toString(16);return 1===t.length?"0"+t:t},r=(e,t,r)=>"#"+n(e)+n(t)+n(r),s=(e=>{const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t&&[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]})(e);if(!s)return e;const[a,i,o]=s;if(a/255**2.2*.2126+i/255**2.2*.7151+o/255**2.2*.0721<=t)return r(a,i,o);const l=(t/(a/255**2.2*.2126+i/255**2.2*.7151+o/255**2.2*.0721))**(1/2.2);return r(Math.floor(l*a),Math.floor(l*i),Math.floor(l*o))}},QbJe:function(e,t,n){var r=n("q1tI"),s=n.n(r),a=n("/MKj"),i=n("xdpg"),o=n("L2Gz"),l=n("Ye/N"),c=n("EgnG"),d=n("n6mq");const u=2640,p=500,h=4e3,m=u+40,g=3,f=["blue","eggplant","green","maroon","midnight","navy","olive","orange","orchid","pine","purple","watermelon"],b=168,w=112,x=[10,-10,0];var S=s.a.memo((function(){const e=Object(r.createRef)();return Object(r.useEffect)(()=>{Object(c.a)({targets:e.current,translateY:["20%","-20%"],opacity:{value:0,delay:m,duration:p},duration:h,easing:"cubicBezier(.35, 0, .7, .7)",fillMode:"forwards"})},[]),s.a.createElement(d.d,{width:"100%",ref:e,dangerouslySetInlineStyle:{__style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",columnGap:"8px"}}},function(){const e=[];let t,n=0;for(let r=0;r<g;r+=1){e.push([]),t=[];for(let e=0;e<f.length;e+=1){const a=f[n];t.push(s.a.createElement(d.d,{color:a,height:b,key:e,marginTop:2,rounding:4,width:w})),(n+=3)>=f.length&&(n=r)}e[r].push(s.a.createElement(d.d,{key:r,marginTop:x[r]},t))}return e}())}));const E=800,y=u+1e3,_=236,C=354;var k=s.a.memo((function({selectedInterest:e}){const t=Object(r.createRef)(),n=Object(r.createRef)(),a=Object(r.createRef)(),i=(e,t)=>Object(c.a)({targets:n.current,opacity:[0,1],delay:y,duration:p,fillMode:"forwards"});Object(r.useEffect)(()=>{Object(c.a)({targets:t.current,scale:[.5,1],translateY:[448,0],opacity:[{value:0,duration:0},{value:1,duration:0}],delay:u,duration:E,easing:"linear",fillMode:"forwards"}),i(n.current),i(a.current)},[]);const o={label:l.a._("Food and Drink","Title for topic","Title for topic"),images:{"400x":{height:561,url:"https://i.pinimg.com/400x/10/31/0a/10310a3d860e8f7f2a5753612a870f5a.jpg",width:400}}},{label:h,name:m,images:g}=e||o,{"400x":{url:f,height:b,width:w}}=g,x=(h||m||"").trim().toLowerCase().replace(/\s/g,"").concat(".com");return s.a.createElement(d.d,{ref:t,height:C,width:_,position:"absolute",marginTop:"auto",marginBottom:"auto",top:!0,bottom:!0,dangerouslySetInlineStyle:{__style:{right:"96px"}}},s.a.createElement(d.x,{height:C,rounding:4,width:_},s.a.createElement(d.s,{alt:l.a._("Pin image","Pin image for nux loading step","Pin image for nux loading step"),color:"darkGray",fit:"cover",naturalHeight:b,naturalWidth:w,src:f})),s.a.createElement(d.d,{ref:n,margin:3,position:"absolute",right:!0,top:!0},s.a.createElement(d.e,{accessibilityLabel:l.a._("Save button"),color:"red",size:"lg",text:l.a._("Save","save button for nux loading step","save button for nux loading step")})),s.a.createElement(d.d,{ref:a,color:"lightGray",margin:3,paddingX:3,paddingY:1,rounding:"pill",position:"absolute",bottom:!0,left:!0,maxWidth:"90%",display:"flex",alignItems:"center",justifyContent:"between"},s.a.createElement(d.d,{alignItems:"center"},s.a.createElement(d.q,{accessibilityLabel:l.a._("link","Pin website url link for nux loading step","Pin website url link for nux loading step"),color:"darkGray",icon:"arrow-up-right",size:12})),s.a.createElement(d.d,{flex:"grow",height:18,marginStart:2,overflow:"hidden"},s.a.createElement(d.R,{size:"sm",truncate:!0,weight:"bold"},x))))}));const I={backgroundColor:"#efefef"},v={transition:"width .4s ease-out"};function T(e,t){return Object.assign({},I,{height:e+"px",borderRadius:t})}function P(e,t){return Object.assign({},v,{width:e+"%",borderRadius:t})}var O=({color:e="darkGray",height:t=8,progress:n=0,outerBorderRadius:r="10px",innerBorderRadius:a="inherit"})=>s.a.createElement(d.d,{width:"100%",overflow:"hidden",dangerouslySetInlineStyle:{__style:T(t,r)}},s.a.createElement(d.d,{height:"inherit",color:e,dangerouslySetInlineStyle:{__style:P(n,a)}})),N=n("eOdZ"),R=n("joD6"),j=n("U4JR"),L=n("vVbV"),A=n("5239"),B=n("ANjH");function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const G=300,D=5100,z=1e3,M=230;var F=Object(B.compose)(Object(a.connect)(null,e=>({dispatchSetNuxStepProgress:t=>e(Object(L.a)(t))})),R.a)(class extends r.PureComponent{constructor(...e){super(...e),U(this,"state",{progressPercent:0}),U(this,"gridCopyRef",Object(r.createRef)()),U(this,"pinCopyRef",Object(r.createRef)()),U(this,"incrementStepAndCompleteLoading",()=>{const{incrementNuxStep:e,isRenux:t}=this.props;if(Object(j.a)(8900,{view:t?213:24,viewParameter:261}),e(),!t){N.a.create("UserStateResource",{state:A.m,value:A.a}).callCreate()}})}componentDidMount(){const{dispatchSetNuxStepProgress:e,isRenux:t}=this.props;if(!t){N.a.create("UserStateResource",{state:A.m,value:A.w}).callCreate()}e("loader"),Object(j.a)(13,{view:t?213:24,viewParameter:261}),this.intervalId=setInterval(()=>this.setState(e=>({progressPercent:Math.min(e.progressPercent+100/(D/G),100)})),G),Object(c.a)({targets:this.gridCopyRef.current,opacity:[1,0],delay:u,duration:p,easing:"linear",fillMode:"forwards"}),Object(c.a)({targets:this.pinCopyRef.current,opacity:[0,1],delay:u+p,duration:p,easing:"linear",fillMode:"forwards"})}componentDidUpdate(e,t){const{progressPercent:n}=t,{progressPercent:r}=this.state;n!==r&&r>=100&&(clearInterval(this.intervalId),setTimeout(this.incrementStepAndCompleteLoading,z))}componentWillUnmount(){clearInterval(this.intervalId)}render(){const{isRenux:e,selectedInterests:t,showProgressBar:n}=this.props,{progressPercent:r}=this.state,a=e?l.a._("We're refreshing your home feed with lots of new Pins...","Details for ReNUX loading step","Details for ReNUX loading step"):l.a._("We're building your home feed with lots of Pins...","Details for nux loading step","Details for nux loading step"),i=l.a._("They are links saved from around the web","Pin education on NUX loading step","Pin education on NUX loading step"),o=s.a.createElement(O,{height:10,innerBorderRadius:"0 32px 32px 0",outerBorderRadius:"32px 32px 0 0",progress:r});return s.a.createElement(d.d,{display:"flex",direction:"column",height:"100%",overflow:"hidden","data-test-id":"nux-complete-loader"},s.a.createElement(d.d,{alignItems:"center",direction:"row",display:"flex",height:"100%",justifyContent:"between",overflow:"hidden",paddingX:12,width:"100%"},s.a.createElement(d.d,{marginStart:12,position:"relative",width:M},s.a.createElement(d.d,{ref:this.gridCopyRef},s.a.createElement(d.p,{size:"md"},l.a._("All set!","Title for nux loading step","Title for nux loading step")),s.a.createElement(d.d,{marginTop:4},s.a.createElement(d.R,null,a))),s.a.createElement(d.d,{ref:this.pinCopyRef,position:"absolute",top:!0},s.a.createElement(d.p,{size:"md"},l.a._("Pins are ideas","Pin education on NUX loading step","Pin education on NUX loading step")),s.a.createElement(d.d,{marginTop:4},s.a.createElement(d.R,null,i)))),s.a.createElement(d.d,{marginEnd:2},s.a.createElement(S,null)),s.a.createElement(k,{selectedInterest:t[0]})),!n&&s.a.createElement(d.d,{height:10,position:"absolute",top:!0,width:"100%"},s.a.createElement(d.d,{height:65,overflow:"hidden",paddingX:2,rounding:8},o)))}}),H=n("IZzd"),X=n("028R"),$=n("0/lc");function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Y=Object(a.connect)(null,(e,t)=>({setNuxUpsellProgress:t=>e(Object($.a)(A.j,t)),dispatchSetNuxStepProgress:t=>e(Object(L.a)(t))}))(class extends r.Component{constructor(...e){super(...e),W(this,"onInstallButtonClicked",()=>{const{isRenux:e}=this.props;H.a.handleExtensionInstall(this.incrementStepAndCompleteLoading),Object(j.a)(101,{component:17,element:280,view:e?213:24,viewParameter:260})}),W(this,"onSkipButtonClick",()=>{const{isRenux:e}=this.props;Object(j.a)(101,{component:17,element:1150,view:e?213:24,viewParameter:260}),this.incrementStepAndCompleteLoading()}),W(this,"incrementStepAndCompleteLoading",()=>{const{incrementNuxStep:e,isRenux:t,setNuxUpsellProgress:n}=this.props;t||n(A.a),e()})}componentDidMount(){const{dispatchSetNuxStepProgress:e,isRenux:t,setNuxUpsellProgress:n}=this.props;t||n(A.w),e("extension"),Object(j.a)(13,{view:t?213:24,viewParameter:260})}render(){const{personalizationCopy:{headerText:e,subHeaderText:t}}=this.props;return s.a.createElement(X.a,{header:e,installClick:this.onInstallButtonClicked,skipClick:this.onSkipButtonClick,subheader:t})}}),K=n("7pfs");function q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const V=({isChecked:e,label:t,selectGender:n,value:r})=>s.a.createElement(K.a,null,({hovered:a,onMouseEnter:i,onMouseLeave:o})=>s.a.createElement(d.d,{"data-test-id":`nux-gender-${t}-label`,onMouseEnter:i,onMouseLeave:o,rounding:a?2:0,color:a?"lightGray":"transparent"},s.a.createElement(d.t,{htmlFor:t},s.a.createElement(d.d,{alignItems:"center",display:"flex",flex:"none",height:60,paddingX:8},s.a.createElement(d.E,{checked:e,id:t,name:"genderOptions",onChange:n,size:"md",value:t}),s.a.createElement(d.d,{display:"flex",flex:"grow",marginStart:6},r))))),Q=({children:e})=>s.a.createElement(d.p,{size:"sm"},e);var J=Object(a.connect)(({viewer:e})=>({gender:e.gender?e.gender:"",customGender:e.customGender?e.customGender:""}),(e,t)=>({dispatchSetNuxStepProgress:t=>e(Object(L.a)(t)),setNuxGenderProgress:t=>e(Object($.a)(A.l,t)),updateGenderInfo:t=>e(Object($.e)({updateUserData:t}))}))(class extends r.PureComponent{constructor(...e){super(...e),q(this,"state",{customGender:this.props.customGender,gender:this.props.gender,showCustomGenderTextfield:this.props.gender===A.z&&this.props.customGender.length>0,showNextButton:[A.h,A.g].includes(this.props.gender)||this.props.customGender.length>0,showCustomGenderDoneButton:this.props.gender===A.z&&this.props.customGender.length>0}),q(this,"setCustomGender",e=>{e.target instanceof HTMLInputElement&&e.target.value.trim().length>0?this.setState({customGender:e.target.value,showCustomGenderDoneButton:!0}):this.state.showNextButton&&e.target instanceof HTMLInputElement?this.setState({customGender:e.target.value,showCustomGenderDoneButton:!1}):this.setState({customGender:"",showCustomGenderDoneButton:!1})}),q(this,"updateGenderCompleteStep",()=>{const{incrementNuxStep:e,isRenux:t,updateGenderInfo:n}=this.props,{customGender:r,gender:s}=this.state;n(s===A.z?{gender:A.z,custom_gender:r.slice(0,30)}:{gender:s}).then(()=>{this.setUserStateCompletedGenderStep(),Object(j.a)(8900,{view:t?213:24,viewParameter:3120}),e()})}),q(this,"logButtonClick",e=>{let t;switch(e){case"genderButton":t=241;break;case"nextButton":t=96;break;case"submitButton":t=11906}t&&Object(j.a)(101,{component:17,element:t,view:this.props.isRenux?213:24,viewParameter:3120})})}componentDidMount(){const{dispatchSetNuxStepProgress:e,isRenux:t,setNuxGenderProgress:n}=this.props;e("gender"),t||n(A.w),Object(j.a)(13,{view:t?213:24,viewParameter:3120})}onSelectGender(e){const{showCustomGenderTextfield:t,showNextButton:n}=this.state;n?this.setState({gender:e,showCustomGenderTextfield:e===A.z},()=>this.logButtonClick("genderButton")):e===A.z||t?this.setState({gender:A.z,customGender:"",showCustomGenderTextfield:!t,showCustomGenderDoneButton:!1},()=>this.logButtonClick("genderButton")):this.setState({gender:e},()=>{this.logButtonClick("genderButton"),this.updateGenderCompleteStep()})}setUserStateCompletedGenderStep(){const{isRenux:e,setNuxGenderProgress:t}=this.props;e||t(A.a)}render(){const{isRenux:e,personalizationCopy:{headerText:t,subHeaderText:n}}=this.props,{customGender:a,showCustomGenderDoneButton:i,showCustomGenderTextfield:o,showNextButton:c}=this.state,u=l.a._("Female","nux.gender.femaleButton","Option for select female gender"),p=l.a._("Male","nux.gender.maleButton","Option for select male gender"),h=l.a._("Specify another","nux.gender.specifyButton","Option for gender besides male and female"),m=l.a._("Enter preferred gender","nux.gender.customGenderPlaceholder","placeholder text for custom gender text field"),g=l.a._("Submit","nux.gender.submitCustomGender","button text for submitting a custom gender type"),f=o?s.a.createElement(r.Fragment,null,s.a.createElement(d.d,{"data-test-id":"nux-gender-unspecified-input",display:"flex",flex:"grow",marginEnd:!c&&i?3:0},s.a.createElement(d.d,{alignItems:"center",width:"100%"},s.a.createElement(d.T,{id:"customGender",onChange:({event:e})=>this.setCustomGender(e),placeholder:a||m,size:"lg"}))),!c&&i&&s.a.createElement(d.d,{"data-test-id":"nux-gender-unspecified-done-btn"},s.a.createElement(d.e,{color:"red",inline:!0,onClick:()=>{this.logButtonClick("submitButton"),this.updateGenderCompleteStep()},size:"lg",text:g}))):s.a.createElement(Q,null,h);return s.a.createElement(d.d,{direction:"column",display:"flex",height:"100%",justifyContent:"start",paddingY:8,width:"100%"},s.a.createElement(d.d,{direction:"column",display:"flex",marginTop:11,paddingX:8,paddingY:8},e?s.a.createElement(d.d,{marginTop:8,paddingY:4},s.a.createElement(d.p,{align:"center",size:"md"},t),s.a.createElement(d.d,{marginTop:3},s.a.createElement(d.R,{align:"center"},n))):s.a.createElement(d.p,{align:"center",size:"lg"},t)),s.a.createElement(d.d,{paddingY:8},s.a.createElement(V,{isChecked:!o&&this.state.gender.toLowerCase()===A.g,label:A.g,selectGender:()=>this.onSelectGender(A.g),value:s.a.createElement(Q,null,u)}),s.a.createElement(V,{isChecked:!o&&this.state.gender.toLowerCase()===A.h,label:A.h,selectGender:()=>this.onSelectGender(A.h),value:s.a.createElement(Q,null,p)}),s.a.createElement(V,{isChecked:o,label:A.z,selectGender:()=>this.onSelectGender(A.z),value:f})),c&&s.a.createElement(d.d,{"data-test-id":"nux_gender_next_btn",marginEnd:8,marginStart:8,marginTop:"auto"},s.a.createElement(d.e,{accessibilityLabel:l.a._("Next","go to next nux step","go to next nux step"),color:"red",disabled:o&&0===this.state.customGender.length,onClick:()=>{this.logButtonClick("nextButton"),this.updateGenderCompleteStep()},size:"lg",text:l.a._("Next","next nux step button","next nux step button"),type:"button"})))}}),Z=n("xAAE"),ee=n("w70y");var te=e=>{const{defaultOptions:t,id:n,items:r,name:a,onChange:i,value:o}=e,l=(r.data||t||[]).sort((e,t)=>e.name.localeCompare(t.name)).map(({name:e,key:t})=>({label:e.toString(),value:t}));return s.a.createElement(d.J,{id:n,name:a,onChange:i,options:l,size:"lg",value:o})};function ne(e){const t=Object(ee.a)({name:"CountriesResource"});return s.a.createElement(te,Object.assign({items:t},e))}function re(e){const t=Object(ee.a)({name:"LocalesResource"});return s.a.createElement(te,Object.assign({items:t},e))}var se=n("QLqj"),ae=n("pLLR");function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const oe="Country";var le=Object(B.compose)(Object(a.connect)(({viewer:e})=>({reduxCountry:e.country?e.country:"",reduxLocale:e.locale?e.locale:""}),(e,t)=>({updateUserInfo:t=>e(Object($.e)(t)),setNuxLocaleProgress:t=>e(Object($.a)(A.k,t)),dispatchSetNuxStepProgress:t=>e(Object(L.a)(t))})),ae.e)(class extends r.PureComponent{constructor(...e){super(...e),ie(this,"state",{locale:this.props.reduxLocale||(this.props.requestContext||{}).locale||A.c,country:this.props.reduxCountry||(this.props.requestContext||{}).country||A.b,swappingLanguage:!1}),ie(this,"onNextButtonClick",()=>{const{incrementNuxStep:e,isRenux:t,updateUserInfo:n,setNuxLocaleProgress:r}=this.props,{country:s,locale:a}=this.state;n({updateUserData:{country:s,locale:a}}).then(()=>{t||r(A.a),Object(j.a)(101,{component:17,element:96,view:24,viewParameter:3139}),Object(j.a)(8900,{view:24,viewParameter:3139}),e()})}),ie(this,"updateLocale",({value:e})=>this.setState({locale:e})),ie(this,"updateCountry",({value:e})=>this.setState({country:e}))}componentDidMount(){const{dispatchSetNuxStepProgress:e,isRenux:t,setNuxLocaleProgress:n}=this.props;t||n(A.w),e("country"),se.b.localStorage.getItem("signupUserLocale")||se.b.localStorage.getItem("signupUserCountry")||Object(j.a)(13,{view:24,viewParameter:3139})}componentDidUpdate(e,t){const{toggleLoadingIndicator:n,isBizNux:r,updateUserInfo:s}=this.props,{country:a,locale:i}=t,{country:o,locale:l}=this.state,c=a!==o,d=i!==l;(c||d)&&s({updateUserData:{country:o,locale:l}}).then(()=>{c&&se.b.localStorage.setItem("signupUserCountry",o),d&&(se.b.localStorage.setItem("signupUserLocale",l),r?this.setState({swappingLanguage:!0}):n(!0),Object(Z.a)("/"))})}render(){const{personalizationCopy:{headerText:e}}=this.props,{country:t,locale:n,swappingLanguage:r}=this.state;return s.a.createElement(d.d,{direction:"column",display:"flex",height:"100%",padding:8,width:"100%"},s.a.createElement(d.d,{alignItems:"center",direction:"column",display:"flex",flex:"grow",justifyContent:"start",marginBottom:7},s.a.createElement(d.d,{marginTop:10,paddingY:5,width:"100%"},s.a.createElement(d.p,{align:"center",size:"md"},e)),s.a.createElement(d.d,{marginTop:12,paddingY:5,width:"100%"},s.a.createElement(d.d,{"data-test-id":"nux-locale-select"},s.a.createElement(re,{id:"newUserLanguage",name:"locale",onChange:this.updateLocale,value:n})),s.a.createElement(d.d,{"data-test-id":"nux-country-select",marginTop:4},s.a.createElement(ne,{id:"newUserCountry",name:"country",onChange:this.updateCountry,value:t})))),s.a.createElement(d.d,{bottom:!0,"data-test-id":"nux-locale-country-next-btn"},s.a.createElement(d.e,{color:"red",disabled:r||t===oe,onClick:this.onNextButtonClick,size:"lg",text:l.a._("Next","go to next step","go to next step"),type:"submit"})))}}),ce=n("XocW"),de=n("Cufx");function ue({account:e,large:t,viewerId:n}){const{email:r,fullName:a,id:i,imageMediumUrl:o,username:l}=e;if(n===i)return null;const c=!(null==o?void 0:o.includes("static/images/user/default"));return s.a.createElement(d.d,{alignItems:"center",direction:"row",display:"flex",height:"100%",width:"100%"},s.a.createElement(d.d,{paddingX:1},s.a.createElement(de.a,{accessibilityLabel:"",name:null!=a?a:l,src:c?o:"",size:t?"lg":"md"})),s.a.createElement(d.d,{marginStart:3,flex:"grow"},s.a.createElement(d.R,{color:"darkGray",truncate:!0,weight:"bold"},a||l),r&&s.a.createElement(d.R,{color:"darkGray",truncate:!0},r)))}var pe=n("0Bqi");var he=e=>{const t=Object.keys(e.accounts).length;return s.a.createElement(d.d,{position:"relative"},s.a.createElement(d.d,{color:"lightGray",height:20*t*4,position:"absolute",width:1,dangerouslySetInlineStyle:{__style:{bottom:48,left:52}}}),s.a.createElement("ul",null,Object.keys(e.accounts).map(t=>{const n=e.accounts[t];return s.a.createElement("li",{key:t},s.a.createElement(d.Q,{onTap:()=>e.onClick(n)},s.a.createElement("div",{className:"AccountSwitcherListItem",style:{padding:"8px 16px 8px 28px"}},s.a.createElement(ue,{account:n}))))})))},me=n("iFas"),ge=n("h4v/"),fe=n("shJ5"),be=n("x/Ro"),we=n("3gA6"),xe=n("NdXn"),Se=n("gC5q"),Ee=n("zLLH"),ye=n("liz/");function _e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ce=Object(B.compose)(ae.e,Object(Ee.c)({key:"businessUser",name:"UserResource",options:({viewer:e})=>({field_set_key:"linked_partner",user_id:e.id})}))(class extends r.Component{constructor(...e){super(...e),_e(this,"state",{failedAccount:null,showLoginModal:!1,isLoading:!1}),_e(this,"handleAddAccount",()=>{Object(ye.k)("add_account_click",null,this.props.container),this.props.container===me.a.ACCOUNT_SWITCHER_MODAL&&this.props.showLogin?this.props.showLogin():this.setState({showLoginModal:!0})}),_e(this,"trackProfileNavigateClick",e=>{Object(ye.k)(`current_profile_${e}_click`,null,this.props.container)}),_e(this,"handleSwitch",e=>{const{container:t}=this.props;this.setState({isLoading:!0}),Object(j.a)(101,{component:13369,element:11196}),Object(ye.k)("switch_account_click",{destination_user_id:e.id},t);const n={get_user:!0,switch_account:e.id};ge.a.getInstance().pauseImpressionsAndFlush(),Object(be.a)(n,{container:"account_switcher"},null,!0).then((n={})=>{if(n.resource_response&&n.resource_response.data&&n.resource_response.data.success){const n=`/${e.username}`;Object(ye.g)(n,e.id,t)}else Object(ye.f)(e.id,t),this.setState({failedAccount:e,isLoading:!1})},n=>{throw Object(ye.f)(e.id,t),this.setState({isLoading:!1}),n})}),_e(this,"handleLinkedAccountSwitch",e=>{const{container:t,viewer:n}=this.props;if(this.setState({isLoading:!0}),Object(j.a)(101,{component:13369,element:e.partner&&e.partner.isLinkedBusiness?11195:11194}),ge.a.getInstance().pauseImpressionsAndFlush(),e.partner&&e.partner.isLinkedBusiness){const n={business_id:e.id,get_user:!0};Object(be.a)(n,{container:"account_switcher"},null,!0).then((n={})=>{Object(ye.g)("/",e.id,t)},n=>{throw Object(ye.f)(e.id,t),this.setState({isLoading:!1}),n})}else N.a.create("UserSessionResource",{disable_auth_failure_redirect:!0}).callDelete().then(()=>{Object(ye.j)(n.id),Object(ye.g)(`/${e.username}`,n.id,t)},e=>{throw Object(ye.f)(n.id,t),this.setState({isLoading:!1}),e})}),_e(this,"handleCloseModal",()=>this.setState({showLoginModal:!1})),_e(this,"handleReauthAccount",()=>{Object(ye.k)("switch_failure_prompt.login_click",null,this.props.container),this.setState({failedAccount:null,showLoginModal:!0})}),_e(this,"handleRemoveUnauthAccount",e=>{Object(ye.k)("switch_failure_prompt.account_removed",{removed_user_id:e},this.props.container),Object(ye.j)(e),this.setState({failedAccount:null})}),_e(this,"getBusinessAccounts",()=>{const{businessUser:e,viewer:{partner:t}}=this.props;return e.data?(t&&t.is_linked_business?e.data.owners:e.data.businesses).reduce((e,t)=>(e[t.id]=Object(Se.a)(xe.a,!0)(t),t.partner&&t.partner.is_linked_business&&(e[t.id].email=t.partner.biz_ownership_email),e),{}):null}),_e(this,"renderAccounts",e=>Object.keys(e).map((t,n)=>s.a.createElement("li",{key:n},s.a.createElement(d.Q,{onTap:()=>{this.handleSwitch(e[t])}},s.a.createElement("div",{className:"AccountSwitcherListItem",style:{height:"auto"}},s.a.createElement(ue,{large:!0,account:e[t],viewerId:this.props.viewer.id}))),n!==ye.a-2&&s.a.createElement(d.l,null)))),_e(this,"renderPinnerButtons",e=>{const{onNavigateButtonClick:t}=this.props;return s.a.createElement(we.b,{className:"dangerouslyDisableFocusStyle",focusOnBody:!0,to:`/${e}/`},s.a.createElement(d.e,{text:l.a._("View profile","Visit a user profile from account switcher","Visit a user profile from account switcher"),accessibilityLabel:l.a._("Go to current profile","Visit a current user profile from account switcher","Visit a current user profile from account switcher"),size:"sm",color:"red",onClick:()=>{this.trackProfileNavigateClick("button"),t&&t()}}))}),_e(this,"renderBusinessButtons",e=>{const{onNavigateButtonClick:t}=this.props;return s.a.createElement(d.d,{display:"flex"},s.a.createElement(d.d,{marginEnd:2},s.a.createElement(we.b,{to:"/business/hub/",onClick:()=>{Object(j.a)(101,{element:11236}),t&&t()}},s.a.createElement(d.e,{key:"biz-hub-button",text:l.a._("Business hub","Link to Business hub from account switcher","Link to Business hub from account switcher"),accessibilityLabel:l.a._("Go to Business hub","Visit the Business hub for the current business user","Visit the Business hub for the current business user"),size:"sm",color:"red"}))),s.a.createElement(we.b,{className:"dangerouslyDisableFocusStyle",focusOnBody:!0,to:`/${e}/`},s.a.createElement(d.e,{text:l.a._("Profile","Visit a user profile from account switcher","Visit a user profile from account switcher"),accessibilityLabel:l.a._("Go to current user profile","Visit a current user profile from account switcher","Visit a current user profile from account switcher"),size:"sm",onClick:()=>{this.trackProfileNavigateClick("button"),t&&t()}})))})}componentDidMount(){this.props.container===me.a.ACCOUNT_SWITCHER_MODAL&&Object(ye.k)("modal.shown")}componentWillUnmount(){this.props.container===me.a.ACCOUNT_SWITCHER_MODAL&&Object(ye.k)("modal.dismiss")}renderLoadingIndicator(){return this.state.isLoading?s.a.createElement(fe.a,null):null}render(){const{viewer:{partner:e}}=this.props,{failedAccount:t,isLoading:n,showLoginModal:r}=this.state,a=Object(ye.e)(),i=this.getBusinessAccounts(),o=Object.keys(a).length,c=a[this.props.viewer.id];delete a[c.id];const u=c.imageLargeUrl&&!c.imageLargeUrl.includes("static/images/user/default");return s.a.createElement(d.d,{flex:"grow"},r&&s.a.createElement(pe.a,{container:this.props.container,onClose:this.handleCloseModal,email:t?t.email:""}),t?s.a.createElement(d.d,{paddingX:4,paddingY:4,flex:"grow"},s.a.createElement(d.d,{marginBottom:3},s.a.createElement(d.R,null,l.a._("Oh no! You're no longer logged into","Full sentence: \"Oh no! You're no longer logged into <user's account>\". Text telling user that they are no longer logged into an account after trying to switch to it","Full sentence: \"Oh no! You're no longer logged into <user's account>\". Text telling user that they are no longer logged into an account after trying to switch to it"))),s.a.createElement(ue,{viewerId:c.id,account:t}),s.a.createElement(d.d,{marginTop:4},s.a.createElement(d.e,{text:l.a._("Log in again","Text on button allowing user to log into an account after failing to switch to that account","Text on button allowing user to log into an account after failing to switch to that account"),color:"red",onClick:this.handleReauthAccount})),s.a.createElement(d.d,{marginTop:3},s.a.createElement(d.e,{text:l.a._("Remove account","Text on button allowing user to remove an account from their account switcher after failing to switch to it","Text on button allowing user to remove an account from their account switcher after failing to switch to it"),onClick:()=>this.handleRemoveUnauthAccount(t.id)}))):s.a.createElement(d.d,null,n&&this.renderLoadingIndicator(),s.a.createElement(d.d,null,s.a.createElement(d.d,{alignItems:"center",direction:"row",display:"flex",marginTop:1,padding:4,position:"relative",dangerouslySetInlineStyle:{__style:{zIndex:1}}},s.a.createElement(d.d,{marginEnd:4},s.a.createElement(we.b,{className:"dangerouslyDisableFocusStyle",focusOnBody:!0,to:`/${c.username}/`},s.a.createElement(d.Q,{onTap:()=>this.trackProfileNavigateClick("avatar")},s.a.createElement(de.a,{name:c.fullName||c.username,size:"lg",src:u?c.imageLargeUrl:""})))),s.a.createElement(d.d,{flex:"grow"},s.a.createElement(d.d,{marginBottom:2},s.a.createElement(d.R,{color:"darkGray",truncate:!0,weight:"bold"},c.fullName||c.username),c.email&&s.a.createElement(d.R,{color:"darkGray",truncate:!0},c.email)),e?this.renderBusinessButtons(c.username):this.renderPinnerButtons(c.username))),i?s.a.createElement(he,{accounts:i,onClick:this.handleLinkedAccountSwitch}):null,s.a.createElement(d.l,null),e&&e.is_linked_business?null:s.a.createElement(d.d,null,s.a.createElement("ul",null,this.renderAccounts(a)))),o<ye.a&&!(e&&e.is_linked_business)&&s.a.createElement(d.d,{paddingX:4,paddingY:3},s.a.createElement(d.e,{text:l.a._("Add account","Short text on the button that allows a user to log in to another Pinterest account","Short text on the button that allows a user to log in to another Pinterest account"),onClick:()=>this.handleAddAccount()}))))}}),ke=n("TiQD");function Ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ve=Object(B.compose)(R.a,Object(Ee.c)({name:"UserResource",key:"businessUser",options:({viewer:e})=>({username:e.username,field_set_key:"linked_partner"})}))(class extends r.Component{constructor(e){super(e),Ie(this,"componentDidMount",()=>{Object(ye.i)(this.props.viewer,this.props.businessUser.data)}),Ie(this,"showLogin",()=>this.setState({showLoginModal:!0})),Ie(this,"hideLogin",()=>this.setState({showLoginModal:!1}));const{showAddAccount:t}=this.props;this.state={showLoginModal:!!t}}render(){const{customTaglineText:e,hideAccountSwitchValueProp:t,onDismiss:n,showAddAccount:r,viewer:a}=this.props;return this.state.showLoginModal?s.a.createElement(pe.a,{container:me.a.ACCOUNT_SWITCHER_MODAL,onClose:r?n:this.hideLogin,customTaglineText:e,hideAccountSwitchValueProp:t}):s.a.createElement(d.d,{position:"relative"},s.a.createElement(ke.b,{accessibilityModalLabel:l.a._("View, add, and switch logged in users","modal which allows user to add and switch multiple accounts","modal which allows user to add and switch multiple accounts"),size:"sm",heading:l.a._("Switch accounts","Short title on modal that allows a user to switch between different Pinterest accounts","Short title on modal that allows a user to switch between different Pinterest accounts"),onDismiss:n},s.a.createElement(Ce,{container:me.a.ACCOUNT_SWITCHER_MODAL,onNavigateButtonClick:()=>n(),showLogin:this.showLogin,viewer:a})))}}),Te=n("KNE1"),Pe=n("V08O");const Oe={yellow:"#FAB904",orange:"#FF6400",green:"#0FA573",blue:"#0074e8",purple:"#B469EB"},Ne="DelightfulBubbles__",Re=[`${Ne}fadeIn {\n  to {\n    opacity: 1;\n  }\n}\n`,`${Ne}growShrink {\n  0% {\n    transform: scale(0);\n  }\n  50% {\n    transform: scale(1);\n  }\n  100% {\n    transform: scale(0);\n  }\n}\n`,`${Ne}swirl {\n  0% {\n    transform: rotate(0deg) translateX(-50%);\n  }\n  100% {\n    transform: rotate(-360deg) translateX(-50%);\n  }\n}\n`,...Object.keys(Oe).map(e=>{const t=((e,t)=>{const n=e.length,r=e.indexOf(t)+1>=n?0:e.indexOf(t)+1;return e[r]})(Object.keys(Oe),e);return`${Ne}colorChange_${e} {\n      0% {\n        background-color: ${Oe[e]};\n      }\n      50% {\n        background-color: ${Oe[t]};\n      }\n    }\n    `})],je=Object(Pe.a)(Re);function Le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Ae=e=>{const{delay:t,diameter:n,height:r,initialColor:a,width:i,xOffset:o,yOffset:l}=e,c=((e,t,n,r,s,a,i,o)=>({bubblePositionStyles:{position:"absolute",marginLeft:`${a/2-s}px`,marginTop:`${n/2-s}px`,left:`${i}px`,top:`${o}px`},bubbleSwirlStyles:{animation:`${Ne}swirl 6s ease-in-out ${e}s infinite forwards`,WebkitAnimation:`${Ne}swirl 6s ease-in-out ${e}s infinite forwards`},bubbleGrowShrinkStyles:{transform:"scale(0)",WebkitTransform:"scale(0)",animation:`${Ne}growShrink 6s ease-in-out ${e}s infinite alternate`,WebkitAnimation:`${Ne}growShrink 6s ease-in-out ${e}s infinite alternate`},bubbleShapeStyles:{height:`${t}px`,width:`${t}px`,borderRadius:"50%",backgroundColor:Oe[r],opacity:0,animation:`${Ne}colorChange_${r} 12s steps(1, start) ${e}s infinite forwards,\n      ${Ne}fadeIn 3s linear ${e}s 1 forwards`,WebkitAnimation:`${Ne}colorChange_${r} 12s steps(1, start) ${e}s infinite forwards,\n      ${Ne}fadeIn 3s linear ${e}s 1 forwards`}}))(t,n,r,a,Math.floor(n/2),i,o,l);return s.a.createElement(d.d,{dangerouslySetInlineStyle:{__style:c.bubblePositionStyles}},s.a.createElement(d.d,{dangerouslySetInlineStyle:{__style:c.bubbleSwirlStyles}},s.a.createElement(d.d,{dangerouslySetInlineStyle:{__style:c.bubbleGrowShrinkStyles}},s.a.createElement(d.d,{dangerouslySetInlineStyle:{__style:c.bubbleShapeStyles}}))))};class Be extends r.Component{constructor(...e){super(...e),Le(this,"state",{isInitialized:!1})}componentDidMount(){this.requestAnimationFrameId=window.requestAnimationFrame(()=>{this.setState({isInitialized:!0})})}shouldComponentUpdate(e,t){return!e.numBubbles===this.props.numBubbles||!t.isInitialized===this.state.isInitialized}getSize(){const{width:e,height:t}=this.props;return void 0!==e&&void 0!==t?{width:e,height:t}:this.containerElement?{height:this.containerElement.offsetHeight,width:this.containerElement.offsetWidth}:{height:void 0,width:void 0}}createBubbles(e,t){const{bubbleSize:n,delayFactor:r,delayOffset:a,numBubbles:i,xRadiusAdjustment:o,yRadiusAdjustment:l}=this.props,c=e+2*l,d=t+2*o,u=[],p=Object.keys(Oe);for(let h=0;h<i;h+=1){const i=n+Object(Pe.c)(-4,4),o=p[h%p.length],{x:l,y:m}=Object(Pe.b)(c,d);u.push(s.a.createElement(Ae,{delay:h*r+a,diameter:i,initialColor:o,xOffset:l,yOffset:m,height:e,width:t,key:h}))}return u}render(){const{height:e,width:t}=this.getSize();return s.a.createElement(d.d,{height:e,width:t,position:"relative"},s.a.createElement(Te.a,{unsafeCSS:je}),s.a.createElement(d.d,{ref:e=>this.containerElement=e},this.state.isInitialized&&this.createBubbles(e||0,t||0),s.a.createElement(d.d,{position:"relative"},this.props.children)))}}Le(Be,"defaultProps",{bubbleSize:16,numBubbles:10,xRadiusAdjustment:0,yRadiusAdjustment:0,delayFactor:1,delayOffset:0});var Ue=Be,Ge=n("28DW"),De=n("0S8y");function ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const Me=120,Fe=44;var He=Object(a.connect)(({viewer:e})=>({firstName:e.firstName?e.firstName:"",userEmail:e.isAuth?e.email:""}),e=>({dispatchSetNuxStepProgress:t=>e(Object(L.a)(t)),updateNameInfo:t=>e(Object($.e)({updateUserData:t})),setNuxNameProgress:()=>e(Object($.a)(A.r,A.a))}))(class extends r.PureComponent{constructor(...e){super(...e),ze(this,"state",{name:this.props.firstName,showAccountSwitchModal:!1,showNameInput:!1,showNoNameError:!1,showNameLengthError:!1}),ze(this,"onNameChange",({value:e})=>{this.setState({name:e||"",showNoNameError:!e||i.h(e),showNameLengthError:!!e&&e.length>30})}),ze(this,"toggleNameInput",()=>{this.setState(({showNameLengthError:e,showNoNameError:t,showNameInput:n})=>({showNameInput:e||t||!n})),Object(j.a)(101,{element:136,view:24,viewParameter:259})}),ze(this,"continueAndSave",()=>{const{firstName:e,incrementNuxStep:t,setNuxNameProgress:n,updateNameInfo:r}=this.props,{name:s}=this.state;r(Object(De.a)(s)).then(()=>{n(),Object(j.a)(101,{element:96,view:24,viewParameter:259,did_edit_name:e!==s}),Object(j.a)(8900,{view:24,viewParameter:259}),t()})}),ze(this,"getError",()=>{const{showNameLengthError:e,showNoNameError:t}=this.state;let n="";return t?n=l.a._("And your name is...?","Error flyout when user doesn't input name","Error flyout when user doesn't input name"):e&&(n=l.a._("Hmm, that's too long. Try a nickname instead?","nux.welcomeStep.nameLengthError","Name exceeds 30 character maximum error")),n}),ze(this,"handleHideAccountSwitcher",()=>this.setState({showAccountSwitchModal:!1})),ze(this,"handleNotYouClick",e=>{e.event.preventDefault(),Object(Ge.a)("web.nux.click_login"),this.setState({showAccountSwitchModal:!0})})}componentDidMount(){this.props.dispatchSetNuxStepProgress("welcome"),Object(j.a)(13,{view:24,viewParameter:259})}render(){const{personalizationCopy:{headerText:e,subHeaderText:t},userEmail:n}=this.props,{name:a,showAccountSwitchModal:o,showNameInput:c}=this.state,u=t.indexOf(" ",Math.round(t.length/2)),p=i.c(l.a._("{{ titleText }} {{ name }}!","nux.welcomeStep.greetingHeader","Greeting with inferred name."),{titleText:e,name:a}).replace(",",""),h=p.indexOf(a)-1,m=this.getError(),g=s.a.createElement(d.d,{dangerouslySetInlineStyle:{__style:{textAlign:"center"}},direction:"column",display:"flex",overflow:"hidden",width:"100%"},s.a.createElement(d.t,{htmlFor:"name"},s.a.createElement(d.d,{marginEnd:-1,marginStart:-1,marginTop:4},s.a.createElement(d.p,{align:"center",size:"md"},c?e:s.a.createElement(r.Fragment,null,p.substring(0,h),s.a.createElement(d.d,{height:Fe,marginStart:9,marginTop:4,paddingY:1},p.substring(h+1),s.a.createElement(d.d,{"data-test-id":"nux-edit-name-btn",display:"inlineBlock",marginStart:1},s.a.createElement(d.r,{accessibilityLabel:l.a._("Edit Name","Botton that allows editing the user's name","Botton that allows editing the user's name"),bgColor:"transparent",icon:"edit",iconColor:"darkGray",onClick:this.toggleNameInput,size:"sm"}))))))),c&&s.a.createElement(d.d,{alignItems:"start","data-test-id":"nux-edit-name-input",display:"flex",justifyContent:"center",marginTop:1,paddingY:1},s.a.createElement(d.d,{width:"69%"},s.a.createElement(d.T,{errorMessage:m,id:"name",onChange:this.onNameChange,placeholder:l.a._("name"),size:"lg",type:"text",value:a})),s.a.createElement(d.d,{"data-test-id":"nux-update-name-btn",marginStart:2},s.a.createElement(d.e,{accessibilityLabel:l.a._("Submit","Button that stores the name of the updated user","Button that stores the name of the updated user"),color:"gray",inline:!0,onClick:this.toggleNameInput,size:"lg",text:l.a._("Submit","Button that stores the name of the updated user","Button that stores the name of the updated user")}))));return s.a.createElement(r.Fragment,null,o&&s.a.createElement(ve,{customTaglineText:l.a._("Log in","Title on modal for users to log in to an existing account after they accidentally created a new account","Title on modal for users to log in to an existing account after they accidentally created a new account"),hideAccountSwitchValueProp:!0,onDismiss:this.handleHideAccountSwitcher,showAddAccount:!0}),s.a.createElement(d.d,{direction:"column",display:"flex",height:"100%",minWidth:"100%",paddingX:8,paddingY:8},s.a.createElement(d.d,{alignItems:"center",direction:"column",display:"flex",flex:"shrink",justifyContent:"start",width:"100%"},s.a.createElement(Ue,{delayOffset:-5,xRadiusAdjustment:40},s.a.createElement(d.d,{height:Me,width:Me},s.a.createElement(de.a,{name:a}))),s.a.createElement(d.d,{alignItems:"center",marginTop:6},s.a.createElement(d.R,{align:"center",size:"lg",truncate:!0},n)),s.a.createElement(d.d,{alignItems:"end",display:"flex",marginTop:2,width:"100%"},g),s.a.createElement(d.d,{marginTop:m?0:6,width:"100%"},t.length>120?s.a.createElement(d.R,{align:"center"},t):s.a.createElement(r.Fragment,null,s.a.createElement(d.R,{align:"center"},t.substring(0,u)),s.a.createElement(d.R,{align:"center"},t.substring(u))))),s.a.createElement(d.d,{"data-test-id":"nux_name_done_btn",marginTop:8},s.a.createElement(d.e,{accessibilityLabel:l.a._("Next","go to next nux step","go to next nux step"),color:"red",disabled:!!m,onClick:this.continueAndSave,size:"lg",text:l.a._("Next","next nux step button","next nux step button"),type:"button"})),s.a.createElement(d.d,{marginBottom:5,marginTop:5},s.a.createElement(d.Q,{fullWidth:!1,onTap:this.handleNotYouClick},s.a.createElement(d.R,{align:"center",size:"sm"},l.a._("Already have a Pinterest account?","subtitle to ask users who create a new account if they meant to log in to an existing account","subtitle to ask users who create a new account if they meant to log in to an existing account")),s.a.createElement(d.R,{align:"center",size:"sm",weight:"bold"},s.a.createElement(d.w,{href:"#"},l.a._("Log in instead","Link allowing users who just created a new account the option to log in instead into an existing account","Link allowing users who just created a new account the option to log in instead into an existing account")))))))}}),Xe=n("CzMn"),$e=n("TSYQ"),We=n.n($e),Ye=n("1inl"),Ke=n("rh3l"),qe=n("lUXN"),Ve=n("N0Eu"),Qe=n("rgAY");var Je=function({clickHandler:e,interest:t,isSelected:n,text:a}){const[i,l]=Object(r.useState)(!1);let c="transparent";const u=!n&&!i;let p={};if(n&&t&&t.background_color){p={backgroundColor:Object(o.c)(t.background_color,5e-4)}}else n?c="darkGray":i&&(c="lightGray");const h=t&&"string"==typeof t.label?t.label:"",m=t?h||t.name:a||"";return s.a.createElement(d.Q,{onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onTap:e,rounding:"pill"},s.a.createElement(d.d,{borderSize:u?"lg":"none",color:c,dangerouslySetInlineStyle:{__style:{...p,borderStyle:u?"solid":"unset",padding:u?"2px":"4px"}},"data-test-id":"nux-picker-topic",direction:"row",display:"flex",height:48,rounding:"pill"},t&&(()=>{if(!t)return null;const{background_color:e,cycling_images:n,images:r}=t,a=r["400x"],o=n?n.map(e=>e["400x"]):[];return s.a.createElement(d.d,{marginEnd:1},s.a.createElement(d.x,{width:40,height:40,rounding:"circle"},o.length>0&&i?s.a.createElement(Qe.a,{backgroundColor:e,cyclingImages:o,imageHeight:40,imageWidth:40,imgLabel:m}):s.a.createElement(d.s,{alt:m,color:e,fit:"cover",naturalHeight:a.height,naturalWidth:a.width,src:a.url})))})(),s.a.createElement(d.d,{alignItems:"center","data-test-id":"nux-picker-topic-label",display:"flex",justifyContent:"center",marginEnd:4,marginStart:t?2:4},s.a.createElement(d.R,{color:n?"white":"darkGray",size:"lg",weight:"bold"},m))))},Ze=n("HZII");function et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const tt=n.n(Ze)()(()=>{se.b.localStorage.setItem("signupInterestsPickerScrollDown",!0)});var nt=Object(B.compose)(Object(a.connect)(({viewer:e})=>({reduxCountry:e.country?e.country:"",reduxLocale:e.locale?e.locale:""}),()=>({})),ae.e)(class extends s.a.PureComponent{constructor(...e){super(...e),et(this,"state",{hoverSection:null,userExpandedSections:[]}),et(this,"gridContainer",s.a.createRef()),et(this,"scrollContainer",s.a.createRef()),et(this,"handleScroll",()=>{const e=this.scrollContainer.current,t=this.gridContainer.current;if(e&&t){tt();const n=e.scrollTop+e.offsetHeight>=t.clientHeight;this.props.handleBottomScroll(n)}}),et(this,"onHoverSection",e=>{this.setState({hoverSection:e})}),et(this,"onHoverLeaveSection",()=>{this.setState({hoverSection:null})}),et(this,"onExpandSectionToggle",(e,t)=>{const{isRenux:n}=this.props,{userExpandedSections:r}=this.state;Object(j.a)(101,{component:36,element:t?11870:11871,view:n?213:24,viewParameter:172}),this.setState({userExpandedSections:t?r.concat(e):r.filter(t=>t!==e)})}),et(this,"renderCategories",e=>{const{interests:t}=this.props,{userExpandedSections:n,hoverSection:r}=this.state,a=new Map;t.forEach(e=>{if(e.category_title){const t=e.category_title,n=a.get(t)||[];n.push(e),a.set(t,n)}});const i=[],o=e?7:5;for(const[c,u]of a.entries()){const t=a.size>2&&u.length>o,p=n.includes(c),h=t&&!p?u.slice(0,o):u,m=!e&&r===c&&t,g=l.a._("See less","nux.topicPicker.see_less","Text on button to show fewer topics"),f=s.a.createElement(d.d,{marginBottom:8},s.a.createElement(d.d,{display:"flex",justifyContent:e?"center":"between",alignItems:"center",padding:1,marginStart:5,marginEnd:5,marginBottom:2},s.a.createElement(d.p,{size:"sm"},c),m&&s.a.createElement(d.Q,{fullWidth:!1,onTap:()=>this.onExpandSectionToggle(c,!p)},s.a.createElement(d.R,{size:"sm",weight:"bold"},p?g:l.a._("See all","nux.topicPicker.see_all","Text on button to expand the number of topics shown")))),this.renderInterests(h,e,e&&t?s.a.createElement(Je,{clickHandler:()=>this.onExpandSectionToggle(c,!p),isSelected:!1,text:p?g:l.a._("See more","nux.topicPicker.see_more","Text on button to expand the number of topics shown")}):void 0));e?i.push(s.a.createElement(d.d,{key:c},f)):i.push(s.a.createElement(d.Q,{key:c,onMouseEnter:()=>this.onHoverSection(c),onMouseLeave:this.onHoverLeaveSection,onTap:()=>{}},f))}return s.a.createElement(s.a.Fragment,null,i)}),et(this,"renderInterests",(e,t,n)=>{const{handleInterestClickFn:r,pickerType:a}=this.props;let i="xl_144";return a===A.s.CATEGORY_PICKER&&(i="lg_181_120"),[A.s.REFINED_CATEGORIZED_TOPIC_PICKER,A.s.CATEGORIZED_TOPIC_PICKER].includes(a)&&(i="lg_144_88"),s.a.createElement(d.d,{display:"flex",marginStart:t?0:5,marginTop:-1,justifyContent:t?"center":"start",wrap:!0},e.map((e,n)=>s.a.createElement(d.d,{key:n,padding:1},t?s.a.createElement(Je,{key:e.id,clickHandler:r(e),interest:e,isSelected:e.is_followed}):s.a.createElement(Ve.a,{key:e.id,clickHandler:r(e),interest:e,isSelected:e.is_followed,size:i}))),n&&s.a.createElement(d.d,{padding:1},n))})}componentDidMount(){this.scrollContainer.current&&this.scrollContainer.current.addEventListener("scroll",this.handleScroll)}componentWillUnmount(){this.scrollContainer.current&&this.scrollContainer.current.removeEventListener("scroll",this.handleScroll)}render(){const{disableScroll:e,interests:t,isNarrow:n,pickerType:r}=this.props,a=r===A.s.CATEGORY_PICKER?{}:{paddingBottom:"40px"},i=r===A.s.REFINED_CATEGORIZED_PILLS_TOPIC_PICKER;return t.length>0&&se.b.localStorage.setItem("signupInterestsPickerStartTime",Date.now()),s.a.createElement(d.d,{ref:this.scrollContainer,dangerouslySetInlineStyle:{__style:a},flex:n?"shrink":"grow",height:"100%",overflow:e?"visible":"scrollY",paddingX:n?0:2,width:n?"65%":"100%"},t.length>0?s.a.createElement(d.d,{ref:this.gridContainer},A.o.has(r)?this.renderCategories(i):s.a.createElement(qe.a,{name:"web_nux_topic_pills",isEligible:r!==A.s.CATEGORY_PICKER},({anyEnabled:e})=>this.renderInterests(t,e))):s.a.createElement(d.K,{accessibilityLabel:l.a._("Loading default interests"),show:!0}))}}),rt=n("zwad"),st=n("XCz/"),at=n("573u");function it(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ot extends r.PureComponent{constructor(...e){super(...e),it(this,"state",{currentCategory:null,hoverCategory:null,defaultInterests:[],defaultInterestsSet:new Set,addedContextualTopics:new Set,numTopicsToShow:null}),it(this,"setShortenedRenuxExp",e=>{const{inShortenedEnabled:t,activateShortenedExpFn:n,setShortenedRenuxContainer:r}=this.props;e.length>0&&"viewed_recs"===Object(o.e)(e[0])&&n&&(n(),t&&(r(),this.setState({numTopicsToShow:5})))}),it(this,"handleInterestClickFn",e=>()=>{const{selectedInterests:t,onSelectedInterestsChange:n}=this.props,r=!Object(o.b)(t,e);n([e],r),this.logInterestClick(r),this.contextualUpdateInterests(new Set([e.id]))}),it(this,"logInterestClick",e=>{const{isRenux:t}=this.props,n=e?1030:1151;Object(j.a)(101,{component:36,element:n,view:t?213:24,viewParameter:172})}),it(this,"componentName",A.n),it(this,"recordRenderLogToServer",()=>{const e=this.renderTimers.pop();e.end(),Ke.default.logToServer(Ke.default.SERVER_LOG_TYPE.RENDER_TIME,Ke.default.HTTP_METHOD.POST,{timing:e.getCompletedTime(),component:this.componentName})}),it(this,"renderTimers",[]),it(this,"onClickCategory",e=>{const{isRenux:t}=this.props;Object(j.a)(101,{component:36,element:11870,view:t?213:24,viewParameter:172}),this.setState({currentCategory:e})}),it(this,"hoverCategory",(e,t)=>{this.setState({hoverCategory:e?t:null})})}getExtraImageSignal(){const{plpImages:e,blpImages:t}=Object(o.a)(),{mostRecentPinImages:n}=this.props,r=e.concat(t);return n.concat(r)}componentDidMount(){const{hideFollowedInterests:e,isRenux:t,pickerType:n,selectedCategories:r,selectedInterests:s}=this.props;let a,i=!1;n===A.s.CATEGORY_PICKER?a=N.a.create("NuxInterestsCategoriesResource",{urlParams:rt.a.getQueryStringParams()}):A.p.has(n)||A.o.has(n)||n===A.s.SIDEBAR_TOPIC_PICKER?(a=N.a.create("NuxInterestsRefinedResource",{extraImageSignal:this.getExtraImageSignal(),labelPfy:A.o.has(n),urlParams:rt.a.getQueryStringParams(),refineWithInterestIds:r.map(e=>e.id),returnCategorized:A.o.has(n)||n===A.s.SIDEBAR_TOPIC_PICKER}),i=t):a=N.a.create("NuxInterestsResource",{is_renux:t,logNetworkTimer:!0,loggerComponentName:A.n,extraImageSignal:this.getExtraImageSignal(),hideFollowedInterests:e,urlParams:rt.a.getQueryStringParams()}),a.callGet({showError:!1},{retries:1}).then(e=>{const t=e.resource_response&&e.resource_response.data;if(t){this.logSignupTiming();const e=t.filter(e=>!i||!e.is_followed),n=this.mapInterestsForDisplay(s,e);this.setShortenedRenuxExp(n);const r=this.state.defaultInterests;this.setState({defaultInterests:n},()=>{r!==n&&this.renderTimers.unshift((new at.a).start())});const a=new Set;n.forEach(e=>{!0===e.is_followed&&a.add(e.id)}),Object.keys(a).length>0&&this.contextualUpdateInterests(a)}}).catch(e=>{Ye.a&&Ye.a.showError(e.message||l.a._("Unable to load topics","Error message when failed to load topics.","Error message when failed to load topics."))})}componentDidUpdate(e,t){const{defaultInterests:n}=this.state;n!==t.defaultInterests&&this.renderTimers.length&&this.recordRenderLogToServer(),n.length>0&&0===t.defaultInterests.length&&this.props.preselect&&this.preselectInterests()}getInterestsWithUpdatedIsFollowed(){const{selectedInterests:e}=this.props,{defaultInterests:t}=this.state,n=t.map(t=>(t.is_followed=Object(o.b)(e,t),t)),r=[...e.filter(e=>"type_ahead_search"===Object(o.e)(e))];return n.concat(...r)}logSignupTiming(){const e=se.b.localStorage.getItem("signupTime");if(e){const t=Date.now()-e;t<A.x&&Ke.default.logToServer(Ke.default.SERVER_LOG_TYPE.SIGNUP_LOAD,Ke.default.HTTP_METHOD.POST,{timing:t,component:"nux"}),se.b.localStorage.removeItem("signupTime")}}mapInterestsForDisplay(e,t){const n=t.map(e=>({...e,is_followed:e.is_followed,label:e.name}));this.props.onSelectedInterestsChange(n.filter(e=>e.is_followed),!0);const r=new Set(e.map(e=>e.id)),s=n.filter(e=>!r.has(e.id));return e.concat(s)}preselectInterests(){const{numberToFollow:e,onSelectedInterestsChange:t}=this.props,{defaultInterests:n}=this.state,r=e||A.f;t(n.slice(0,r),!0)}contextualUpdateInterests(e){const{defaultInterests:t,defaultInterestsSet:n,addedContextualTopics:r}=this.state,s=[],a=[];let i=!1;t.forEach(t=>{if(s.push(t),n.add(t.id),e.has(t.id)&&!r.has(t.id)){const e=t.contextual_interests.filter(e=>!n.has(e.id));e.length>0&&("InsertionStrategy.INSERT_INPLACE"===t.contextual_insertion_strategy?s.push(...e):"InsertionStrategy.INSERT_AT_THE_END"===t.contextual_insertion_strategy&&a.push(...e),e.forEach(e=>{n.add(e.id)}),i=!0)}}),a.length>0&&s.push(...a),i&&this.setState({addedContextualTopics:new Set([...r,...e]),defaultInterests:s})}renderSidebar(e){const{currentCategory:t,hoverCategory:n}=this.state,r=l.a._("Picked for You","categorizedTopicPicker.PickedForYou","Category title for a collection of personalized topics just for the user");return s.a.createElement(d.d,{display:"flex",direction:"column",width:"33%"},s.a.createElement("div",{className:We()("hoverScrollbar")},s.a.createElement(d.d,{marginBottom:4},[r].concat(e).map(e=>{const a=e===(t||r),i=!a&&e===n?"lightGray":"transparent";return s.a.createElement(d.d,{key:e,margin:1,display:"flex"},s.a.createElement(d.Q,{fullWidth:!1,onMouseEnter:()=>this.hoverCategory(!0,e),onMouseLeave:()=>this.hoverCategory(!1,e),onTap:()=>this.onClickCategory(e===r?null:e),rounding:"pill"},s.a.createElement(d.d,{color:a?"darkGray":i,padding:4,rounding:"pill"},s.a.createElement(d.R,{align:"left",size:"lg",color:a?"white":"darkGray",weight:"bold"},e))))}))))}render(){const{handleBottomScroll:e,isRenux:t,pickerType:n,selectedInterests:r}=this.props,{currentCategory:a,numTopicsToShow:i}=this.state,o=this.getInterestsWithUpdatedIsFollowed(),l=a?o.filter(e=>e.category_title===a):o,c=[...new Set(o.map(e=>e.category_title||"").filter(e=>!!e))],u=c.length>0&&n===A.s.SIDEBAR_TOPIC_PICKER,p=s.a.createElement(nt,{key:a,disableScroll:!!i&&i<=5,handleBottomScroll:e,handleInterestClickFn:this.handleInterestClickFn,interests:i?l.slice(0,i):l,isNarrow:u,isRenux:!!t,pickerType:n,selectedInterests:r});return u?s.a.createElement(d.d,{overflow:"hidden",height:"100%",display:"flex",alignContent:"between",justifyContent:"between",paddingX:7},this.renderSidebar(c),s.a.createElement(d.l,null),p):p}}var lt=Object(a.connect)(({mostRecentPin:e})=>({mostRecentPinImages:e&&e.plp_image_signatures?e.plp_image_signatures:[]}),()=>({}))(e=>s.a.createElement(st.a,{activate:!1,isEligible:e.isRenux&&!e.isSimpleRenux,name:"web_renux_short"},({anyEnabled:t,customActivate:n})=>s.a.createElement(ot,Object.assign({},e,{activateShortenedExpFn:n,inShortenedEnabled:t})))),ct=n("DzJC"),dt=n.n(ct),ut=n("vvax"),pt=n("/5zs");function ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const mt=s.a.createElement(d.d,{dangerouslySetInlineStyle:{__style:{background:"linear-gradient(rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.1))"}},height:20,left:!0,marginTop:-5,position:"absolute",right:!0,top:!0}),gt=e=>e===A.s.CATEGORY_PICKER?3407:A.p.has(e)?3408:172;var ft=Object(B.compose)(ae.e,Object(a.connect)(null,(function(e){return{dispatchSetNuxStepProgress:t=>e(Object(L.a)(t)),dispatchUpdateFollows:t=>e(Object($.d)(t,"renux")),dispatchSubmitOrientationContext:t=>e(Object($.b)(t)),setNuxPickerProgress:t=>e(Object($.a)(A.q,t))}})))(class extends r.Component{constructor(...e){super(...e),ht(this,"state",{isBottom:!1,showShortRenux:!1}),ht(this,"getButtonAttributes",()=>{const{hideFollowedInterests:e,isRenux:t,pickerType:n,numberToFollow:r,selectedCategories:s,selectedInterests:a}=this.props,{isBottom:o}=this.state;if(n===A.s.CATEGORY_PICKER){const n=s.length,a=Math.max(0,r-n),o=l.a.ngettext("Pick {{ numberLeftToFollow }} category","Pick {{ numberLeftToFollow }} categories",a,"nux.picker.next_button","number of categories left to pick"),c=t&&e?l.a._("Next","go to next step","go to next step"):i.i(o,{numberLeftToFollow:`${a}`});return{text:a>0?c:l.a._("Next","go to next step","go to next step"),isDisabled:a>0}}const c=a.length,d=n===A.s.STANDARD_TOPIC_PICKER&&o&&c>=A.i?0:Math.max(0,r-c),u=l.a.ngettext("Pick {{ numberLeftToFollow }} more","Pick {{ numberLeftToFollow }} more",d,"number of interests left to pick","number of interests left to pick"),p=t&&e?l.a._("Next","go to next step","go to next step"):i.i(u,{numberLeftToFollow:`${d}`});return{text:d>0?p:l.a._("Done"),isDisabled:d>0}}),ht(this,"setShortenedRenux",()=>{const{setShortenedRenuxModal:e}=this.props;e(),this.setState({showShortRenux:!0})}),ht(this,"handleBottomScroll",e=>this.setState({isBottom:e})),ht(this,"handleBottomScrollThrottled",dt()(this.handleBottomScroll,50)),ht(this,"handleNextClick",()=>{const{isRenux:e,selectedCategories:t,selectedInterests:n,followedInterests:r,pickerType:s,setNuxPickerProgress:a,dispatchUpdateFollows:i,dispatchSubmitOrientationContext:o,requestContext:l}=this.props;if(s===A.s.CATEGORY_PICKER){const e=gt(s);return Object(j.a)(101,{component:17,element:96,view:this.viewType,viewParameter:e}),void this.logAndIncrementNuxStep(this.viewType,e)}let c;if(e){const e=t.length>0&&new pt.c(l,"web_nux_topic_two_step_follow_categories").enabled()?t.reduce((e,t)=>(e[t.id]=t.is_followed,e),{}):{},n=r.reduce((e,t)=>(e[t.id]=t.is_followed,e),{});c=Promise.resolve(i({...e,...n}))}else{const e=[],t=[];n.forEach(n=>{e.push(n.id),t.push(n.log_data?n.log_data:null)});const r={interests:e.join(),log_data:JSON.stringify(t),referrer:"nux",user_behavior_data:Object(Xe.a)()};c=Promise.resolve(o(r))}c.then(()=>{e||a(A.a),s!==A.s.STANDARD_TOPIC_PICKER&&Object(j.a)(101,{component:17,element:96,view:this.viewType,viewParameter:gt(s)}),Object(j.a)(101,{component:17,element:96,view:this.viewType,viewParameter:172}),this.logAndIncrementNuxStep(this.viewType,172)})}),ht(this,"logAndIncrementNuxStep",(e,t)=>{Object(j.a)(8900,{view:e,viewParameter:t}),this.props.incrementNuxStep()})}componentDidMount(){const{dispatchSetNuxStepProgress:e,isRenux:t,pickerType:n,setNuxPickerProgress:r}=this.props;t||r(A.w),this.viewType=t?213:24,e("topic"),[A.s.CATEGORY_PICKER,A.s.STANDARD_TOPIC_PICKER].includes(n)&&Object(j.a)(13,{view:this.viewType,viewParameter:172}),n!==A.s.STANDARD_TOPIC_PICKER&&Object(j.a)(13,{view:this.viewType,viewParameter:gt(n)})}render(){const{hideFollowedInterests:e,isRenux:t,isSimpleRenux:n,onSelectedInterestsChange:r,personalizationCopy:{headerText:a,subHeaderText:i},pickerType:o,preselect:c,selectedCategories:u,selectedInterests:p,numberToFollow:h}=this.props,{showShortRenux:m}=this.state,g=this.getButtonAttributes(),f=o===A.s.CATEGORY_PICKER?u:p,b=m||o===A.s.CATEGORY_PICKER,w=[A.s.CATEGORY_PICKER,A.s.REFINED_TOPIC_PICKER].includes(o),x=t&&!w;return s.a.createElement(d.d,{direction:"column",display:"flex",height:"100%"},s.a.createElement(d.d,{display:"visuallyHidden",role:"alert"},Object(ut.b)(l.a._("{{selectedTopicsCount}} of at least 5 topics selected","accessible label how many topics are selected","accessible label how many topics are selected"),{selectedTopicsCount:f.length})),s.a.createElement(d.d,{marginBottom:8,marginTop:x?8:4,paddingX:8,wrap:!0},s.a.createElement(d.p,{align:"center",size:"md"},a),i&&s.a.createElement(d.d,{marginTop:2},s.a.createElement(d.R,{align:"center"},i))),s.a.createElement(lt,{handleBottomScroll:this.handleBottomScrollThrottled,hideFollowedInterests:e,isRenux:t,isSimpleRenux:n,numberToFollow:h,onSelectedInterestsChange:r,pickerType:o,preselect:c,selectedCategories:u,selectedInterests:f,setShortenedRenuxContainer:this.setShortenedRenux}),s.a.createElement(d.d,{position:"relative"},!b&&mt,s.a.createElement(d.d,{"data-test-id":"nux-picker-done-btn",marginBottom:8,marginTop:8,paddingX:8},s.a.createElement(d.e,{color:"red",disabled:g.isDisabled,onClick:this.handleNextClick,size:"lg",text:g.text,type:"submit"}))))}});var bt=n("C0mq");function wt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class xt extends r.Component{constructor(...e){super(...e),wt(this,"state",{followedInterests:[],isLoading:!1,nuxStep:this.getNextStepIndex(-1,this.props.steps,!1),selectedCategories:[],selectedInterests:[],userClickedBack:!1,showShortRenuxModal:!1}),wt(this,"onComplete",()=>{const{handleComplete:e,isLandingPage:t,isRenux:n,dispatchUpdateFirstHomeFeedRequestAfterNuxFlag:r}=this.props;Object(j.a)(4105,{view:n?213:24,viewParameter:171}),n||r(!0),e(),t&&this.handleNavigate("/")}),wt(this,"mounted",!1),wt(this,"handleNavigate",e=>{const{history:t}=this.props;t.push({pathname:e,state:{completedNux:!0}})}),wt(this,"handleSelectedInterestsChange",(e,t)=>{this.setState(this.isCategoryPickerStep()?(n,r)=>{return{selectedCategories:this.getUpdatedSelectedInterests(n.selectedCategories,e,t)}}:(n,r)=>{const s=this.getUpdatedSelectedInterests(n.selectedInterests,e,t),a=this.getUpdatedFollowInterests(n.followedInterests,e,t),{dispatchSetNuxSelectedInterestImages:i}=r;return i(s.reduce((e,t)=>{if(t&&t.images&&t.images["400x"]){const n={bestPinsImages:t.best_pins_images,height:t.images["400x"].height,width:t.images["400x"].width,url:t.images["400x"].url};e.push(n)}return e},[])),{selectedInterests:s,followedInterests:a}})}),wt(this,"nuxSteps",{NuxWelcomeNameStep:He,NuxGenderStep:J,NuxLocaleCountryStep:le,NuxPicker:ft,NuxExtensionUpsell:Y,NuxEducationLoader:F}),wt(this,"setShortenedRenuxModal",()=>this.setState({showShortRenuxModal:!0})),wt(this,"onPrevStepClickFn",e=>{const{steps:t,isRenux:n}=this.props,r=t[e].moduleName,s=this.getPickerType();return()=>{const t={NuxWelcomeNameStep:259,NuxGenderStep:3120,NuxLocaleCountryStep:3139,NuxPicker:gt(s)}[r];t&&Object(j.a)(101,{component:17,element:34,view:n?213:24,viewParameter:t}),e>0&&this.setState({nuxStep:e-1,userClickedBack:!0})}})}componentDidMount(){const{isRenux:e,isSimpleRenux:t,requestContext:n}=this.props;e&&!t&&(new pt.c(n,"web_renux_topic_two_step").enabled(),new pt.c(n,"web_renux_topic_two_step_row").enabled()),this.mounted=!0,Object(j.a)(4104,{view:e?213:24,viewParameter:170})}componentWillUnmount(){this.mounted=!1}getUpdatedFollowInterests(e,t,n){let r=[...e];return t.forEach(e=>{const t={...e,is_followed:n};let s=!1;r=r.map(e=>e.id===t.id?(s=!0,t):e),s||r.push(t)}),r}getUpdatedSelectedInterests(e,t,n){let r=[...e];return t.forEach(t=>{const s=Object(o.b)(r,t);n&&!s?r.push({...t,is_followed:n}):!n&&s&&(r=e.filter(e=>e.id!==t.id))}),r}getPickerType(){const{steps:e}=this.props,{nuxStep:t}=this.state,n=e[t];return this.getPickerTypeFromStep(n)}getPickerTypeFromStep(e){const t=e.options&&e.options.pickerType;return t&&Object.values(A.s).includes(t)?t:A.s.STANDARD_TOPIC_PICKER}isCategoryPickerStep(){return this.getPickerType()===A.s.CATEGORY_PICKER}isRefinedPickerStep(){return A.p.has(this.getPickerType())}getPickerSubHeaderText(){const{requestContext:e}=this.props,t=new pt.b(e,"web_nux_picker_subheader");return t.check("variant_0")?l.a._("Pro tip: We use topics you pick here to build your home feed","nux.picker.subheader","message about what a topic is and why users should choose it "):t.check("variant_1")?l.a._("We use the topics you pick to find ideas you like ","nux.picker.subheader","message about what a topic is and why users should choose it "):""}getPersonalizationCopy(e){const{hideFollowedInterests:t,isRenux:n,isSimpleRenux:r,requestContext:s,steps:a}=this.props;let o,c;const d=e.moduleName,u=a.map(e=>e.moduleName).indexOf(d)===a.length-2;switch(d){case"NuxWelcomeNameStep":return{headerText:new pt.c(s,"web_nux_simplified_welcome").enabledWithNoActivation()?l.a._("Welcome to Pinterest!","nux.welcomeStep.greeting","Nux welcome step heading"):l.a._("Welcome to Pinterest","greeting on welcome name step","greeting on welcome name step"),subHeaderText:l.a._("Your answers to the next few questions will help us find the right ideas for you","header on nux welcome and name editing step","header on nux welcome and name editing step")};case"NuxGenderStep":return o=l.a._("How do you identify?","Header in NUX gender step.","Header in NUX gender step."),c="",n&&(o=l.a._("Its time to refresh your feed!","Title on the modal asking user's gender","Title on the modal asking user's gender"),c=l.a._("How would you describe yourself?","Subtitle on the modal asking user's gender","Subtitle on the modal asking user's gender")),{headerText:o,subHeaderText:c};case"NuxLocaleCountryStep":return{headerText:l.a._("Pick your language and country/region","Header in NUX locale/country step","Header in NUX locale/country step")};case"NuxPicker":const e=r&&new pt.c(s,"web_topic_educator_lego").enabledWithNoActivation();return!n&&this.isCategoryPickerStep()?o=i.i(l.a.ngettext("Pick at least {{numCategoriesToSelect}} category you want to explore","Pick at least {{numCategoriesToSelect}} categories you want to explore",A.d,"nux.topicPicker.heading","Header in NUX topic picker step, asking user to select some number of categories"),{numCategoriesToSelect:A.d.toString()}):!n&&this.isRefinedPickerStep()?(o=i.i(l.a.ngettext("Now pick {{numberToFollow}} (or more!) topics to go deeper","Now pick {{numberToFollow}} (or more!) topics to go deeper",A.e,"nux.topicPicker.heading","Header in NUX topic picker step, asking user to select some number of topics"),{numberToFollow:A.e.toString()}),c=this.getPickerSubHeaderText()):n&&this.isCategoryPickerStep()?o=l.a._("Pick the categories you want to explore","nux.topicPicker.heading","Header in NUX topic picker step, asking users to select some categories"):n&&this.isRefinedPickerStep()?o=l.a._("Now pick a few topics to go deeper","nux.topicPicker.heading","Header in NUX topic picker step, asking users to select some topics"):n&&t?(o=l.a._("What are you into these days?","Header in ReNUX topic picker step.","Header in ReNUX topic picker step."),c=l.a._("Pick the topics you want to see in your home feed","Subheader in ReNUX topic picker step.","Subheader in ReNUX topic picker step.")):e?(o=l.a._("Which topics do you want to see more of?","nux.topicPicker.heading","Header in NUX topic picker step for topic education experience."),c=l.a._("Ideas you see in you home feed are based on topics you like","nux.topicPicker.subheading","Subheader in NUX topic picker step for topic education experience.")):(o=u?l.a._("Last step! Tell us what you're interested in","Header in NUX topic picker step.","Header in NUX topic picker step."):l.a._("Tell us what you're interested in","Header in NUX topic picker step.","Header in NUX topic picker step."),c=this.getPickerSubHeaderText()),{headerText:o,subHeaderText:c};case"NuxExtensionUpsell":return{headerText:o=u?l.a._("Last step! Get our handy browser button","Header in NUX browser extension upsell step.","Header in NUX browser extension upsell step."):l.a._("Get our handy browser button","Header in NUX browser extension upsell step.","Header in NUX browser extension upsell step."),subHeaderText:l.a._("Quickly save any idea you find around the web","Subheader in NUX browser extension upsell step","Subheader in NUX browser extension upsell step")};default:return{}}}nuxStepToRender(e,t){const{hideFollowedInterests:n,isRenux:r,isSimpleRenux:a,requestContext:i}=this.props,{followedInterests:o,selectedCategories:l,selectedInterests:c}=this.state,d=e.moduleName,u=this.nuxSteps[d],p=this.hasNuxStep("NuxGenderStep"),h=r&&n?A.u:A.e,m=r?A.t:A.d;return s.a.createElement(u,Object.assign({},e.options,{key:this.getPickerType(),experiments:i.experiments,followedInterests:o,hasGenderStep:p,hideFollowedInterests:n,incrementNuxStep:this.incrementNuxStep(this.state.nuxStep),isRenux:r,isSimpleRenux:a,numberToFollow:this.isCategoryPickerStep()?m:h,onSelectedInterestsChange:this.handleSelectedInterestsChange,personalizationCopy:this.getPersonalizationCopy(e),pickerType:this.getPickerType(),requestContext:i,selectedCategories:l,selectedInterests:c,setShortenedRenuxModal:this.setShortenedRenuxModal,showTableOfContents:t,toggleLoadingIndicator:e=>this.setState({isLoading:e})}))}getNextStepIndex(e,t,n){const{isRenux:r}=this.props;let s=e+1;if(n)return s;if(!r)for(;s<t.length&&t[s].isCompleted;)s+=1;return s}incrementNuxStep(e){const{steps:t}=this.props,{userClickedBack:n}=this.state,r=this.getNextStepIndex(e,t,n);return r>=t.length?this.onComplete:()=>{(t=>{if(e!==t)this.setState({nuxStep:t})})(r)}}hasNuxStep(e){const{steps:t}=this.props;return t.some(t=>t.moduleName===e)}render(){const{handleDismiss:e,isLandingPage:t,isRenux:n,isSimpleRenux:r,steps:a}=this.props,{isLoading:i,nuxStep:o,showShortRenuxModal:l}=this.state,c=e=>["NuxEducationLoader"].includes(e),d=a.filter(e=>!c(e.moduleName)),u=c(a[o].moduleName)||t,p=a.filter(e=>A.p.has(this.getPickerTypeFromStep(e))).length>0,h=n?!u&&!r&&o>0:!u&&!r&&o>1;return s.a.createElement(ce.a,{currentIndex:o,hideDots:(n||r)&&!p||u,isLoading:i,numSteps:d.length,onClose:u||!n&&!r?void 0:e,onPrevStepClick:h?this.onPrevStepClickFn(o):void 0,showShortRenuxPicker:l,stepName:a[o].moduleName},this.nuxStepToRender(a[o],!u))}}wt(xt,"defaultProps",{hideFollowedInterests:!1,isRenux:!1,isSimpleRenux:!1});t.a=Object(B.compose)(ae.e,Object(a.connect)(()=>({}),e=>({dispatchSetNuxSelectedInterestImages:t=>e(function(e){return{type:"SET_NUX_SELECTED_INTEREST_IMAGES",payload:{images:e}}}(t)),dispatchUpdateFirstHomeFeedRequestAfterNuxFlag:t=>e(Object($.c)(t))})),bt.a)(xt)},vVbV:function(e,t,n){function r(e){return{type:"SET_NUX_PROGRESS",payload:{step:e}}}n.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/js/RenuxContainerCommon-619c8564357f818ce071.mjs.map